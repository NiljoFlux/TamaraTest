<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drag and Drop Beispiel mit vollständigem SVG-Raster</title>
    <style>
        #container {
            width: 100%;
            height: auto;
            border: 2px solid #000;
            position: relative;
        }
        svg {
            width: 100%;
            height: auto;
        }
        .draggable {
            position: absolute;
            cursor: move;
            touch-action: none; /* Verhindert das Standardverhalten bei Touch */
        }
        .rectangle {
            background-color: red;
            height: 128px; /* Höhe eines Rechtecks (2 Raster) */
            width: 192px; /* Breite eines Rechtecks (3 Raster) */
        }
        .square {
            background-color: blue;
            height: 128px; /* Höhe eines Quadrats (2 Raster) */
            width: 128px; /* Breite eines Quadrats (2 Raster) */
        }
        @media (max-width: 600px) {
            svg {
                width: 100%;
                height: auto;
            }
            .rectangle {
                height: 32px; /* Höhe eines Rechtecks (0,5 Raster) */
                width: 64px; /* Breite eines Rechtecks (1 Raster) */
            }
            .square {
                height: 32px; /* Höhe eines Quadrats (0,5 Raster) */
                width: 32px; /* Breite eines Quadrats (0,5 Raster) */
            }
        }
    </style>
</head>
<body>
    <div id="container">
        <svg viewBox="0 0 2240 1600" xmlns="http://www.w3.org/2000/svg">
            <!-- Außenrahmen -->
            <rect x="0" y="0" width="2240" height="1600" fill="none" stroke="black" stroke-width="2"/>
            <!-- Rasterlinien -->
            <g stroke="black" stroke-width="0.5">
                <!-- Horizontal lines -->
                <line x1="64" y1="64" x2="2176" y2="64"/>
                <line x1="64" y1="128" x2="2176" y2="128"/>
                <line x1="64" y1="192" x2="2176" y2="192"/>
                <line x1="64" y1="256" x2="2176" y2="256"/>
                <line x1="64" y1="320" x2="2176" y2="320"/>
                <line x1="64" y1="384" x2="2176" y2="384"/>
                <line x1="64" y1="448" x2="2176" y2="448"/>
                <line x1="64" y1="512" x2="2176" y2="512"/>
                <line x1="64" y1="576" x2="2176" y2="576"/>
                <line x1="64" y1="640" x2="2176" y2="640"/>
                <line x1="64" y1="704" x2="2176" y2="704"/>
                <line x1="64" y1="768" x2="2176" y2="768"/>
                <line x1="64" y1="832" x2="2176" y2="832"/>
                <line x1="64" y1="896" x2="2176" y2="896"/>
                <line x1="64" y1="960" x2="2176" y2="960"/>
                <line x1="64" y1="1024" x2="2176" y2="1024"/>
                <line x1="64" y1="1088" x2="2176" y2="1088"/>
                <line x1="64" y1="1152" x2="2176" y2="1152"/>
                <line x1="64" y1="1216" x2="2176" y2="1216"/>
                <line x1="64" y1="1280" x2="2176" y2="1280"/>
                <line x1="64" y1="1344" x2="2176" y2="1344"/>
                <line x1="64" y1="1408" x2="2176" y2="1408"/>
                <line x1="64" y1="1472" x2="2176" y2="1472"/>
                <line x1="64" y1="1536" x2="2176" y2="1536"/>
                <!-- Vertikale Linien -->
                <line x1="64" y1="64" x2="64" y2="1536"/>
                <line x1="128" y1="64" x2="128" y2="1536"/>
                <line x1="192" y1="64" x2="192" y2="1536"/>
                <line x1="256" y1="64" x2="256" y2="1536"/>
                <line x1="320" y1="64" x2="320" y2="1536"/>
                <line x1="384" y1="64" x2="384" y2="1536"/>
                <line x1="448" y1="64" x2="448" y2="1536"/>
                <line x1="512" y1="64" x2="512" y2="1536"/>
                <line x1="576" y1="64" x2="576" y2="1536"/>
                <line x1="640" y1="64" x2="640" y2="1536"/>
                <line x1="704" y1="64" x2="704" y2="1536"/>
                <line x1="768" y1="64" x2="768" y2="1536"/>
                <line x1="832" y1="64" x2="832" y2="1536"/>
                <line x1="896" y1="64" x2="896" y2="1536"/>
                <line x1="960" y1="64" x2="960" y2="1536"/>
                <line x1="1024" y1="64" x2="1024" y2="1536"/>
                <line x1="1088" y1="64" x2="1088" y2="1536"/>
                <line x1="1152" y1="64" x2="1152" y2="1536"/>
                <line x1="1216" y1="64" x2="1216" y2="1536"/>
                <line x1="1280" y1="64" x2="1280" y2="1536"/>
                <line x1="1344" y1="64" x2="1344" y2="1536"/>
                <line x1="1408" y1="64" x2="1408" y2="1536"/>
                <line x1="1472" y1="64" x2="1472" y2="1536"/>
                <line x1="1536" y1="64" x2="1536" y2="1536"/>
                <line x1="1600" y1="64" x2="1600" y2="1536"/>
                <line x1="1664" y1="64" x2="1664" y2="1536"/>
                <line x1="1728" y1="64" x2="1728" y2="1536"/>
                <line x1="1792" y1="64" x2="1792" y2="1536"/>
                <line x1="1856" y1="64" x2="1856" y2="1536"/>
                <line x1="1920" y1="64" x2="1920" y2="1536"/>
                <line x1="1984" y1="64" x2="1984" y2="1536"/>
                <line x1="2048" y1="64" x2="2048" y2="1536"/>
                <line x1="2112" y1="64" x2="2112" y2="1536"/>
            </g>
            <!-- Freie Bereiche um den Rand und in der Mitte -->
            <g fill="white" stroke="none">
                <!-- Rand -->
                <rect x="0" y="0" width="64" height="1600"/>
                <rect x="2176" y="0" width="64" height="1600"/>
                <rect x="0" y="0" width="2240" height="64"/>
                <rect x="0" y="1536" width="2240" height="64"/>
                <!-- Mittlerer Bereich (horizontal) -->
                <rect x="0" y="704" width="2240" height="192"/>
            </g>
        </svg>

        <div class="draggable rectangle" style="top: 128px; left: 128px;"></div>
        <div class="draggable rectangle" style="top: 320px; left: 128px;"></div>
        <div class="draggable rectangle" style="top: 512px; left: 128px;"></div>
        <div class="draggable rectangle" style="top: 704px; left: 128px;"></div>
        <div class="draggable square" style="top: 896px; left: 128px;"></div>
        <div class="draggable square" style="top: 1088px; left: 128px;"></div>
        <div class="draggable square" style="top: 1280px; left: 128px;"></div>
        <div class="draggable square" style="top: 1472px; left: 128px;"></div>
    </div>

    <script>
        document.querySelectorAll('.draggable').forEach(item => {
            let isDragging = false;
            let isRotating = false;
            let rotationAngle = 0;

            item.addEventListener('mousedown', startDrag);
            item.addEventListener('touchstart', startDrag);

            function startDrag(e) {
                e.preventDefault();
                if (e.type === 'touchstart' && e.touches.length === 2) {
                    isRotating = true;
                    startRotate(e);
                } else if (e.type === 'mousedown' || (e.type === 'touchstart' && e.touches.length === 1)) {
                    isDragging = true;
                    let shiftX, shiftY;
                    if (e.type === 'touchstart') {
                        shiftX = e.touches[0].clientX - item.getBoundingClientRect().left;
                        shiftY = e.touches[0].clientY - item.getBoundingClientRect().top;
                    } else {
                        shiftX = e.clientX - item.getBoundingClientRect().left;
                        shiftY = e.clientY - item.getBoundingClientRect().top;
                    }

                    function moveAt(pageX, pageY) {
                        item.style.left = pageX - shiftX + 'px';
                        item.style.top = pageY - shiftY + 'px';
                    }

                    function onMouseMove(event) {
                        if (isDragging) {
                            if (event.type === 'touchmove') {
                                moveAt(event.touches[0].pageX, event.touches[0].pageY);
                            } else {
                                moveAt(event.pageX, event.pageY);
                            }
                        }
                    }

                    document.addEventListener('mousemove', onMouseMove);
                    document.addEventListener('touchmove', onMouseMove);

                    item.onmouseup = function() {
                        document.removeEventListener('mousemove', onMouseMove);
                        document.removeEventListener('touchmove', onMouseMove);
                        isDragging = false;
                        item.onmouseup = null;
                    };

                    item.ontouchend = function() {
                        document.removeEventListener('mousemove', onMouseMove);
                        document.removeEventListener('touchmove', onMouseMove);
                        isDragging = false;
                        item.ontouchend = null;
                    };
                }
            }

            function startRotate(e) {
                let initialAngle = getAngle(e.touches);
                function onTouchMove(event) {
                    if (isRotating && event.touches.length === 2) {
                        let currentAngle = getAngle(event.touches);
                        rotationAngle += currentAngle - initialAngle;
                        item.style.transform = `rotate(${rotationAngle}deg)`;
                        initialAngle = currentAngle;
                    }
                }

                function onTouchEnd(event) {
                    if (event.touches.length < 2) {
                        document.removeEventListener('touchmove', onTouchMove);
                        document.removeEventListener('touchend', onTouchEnd);
                        isRotating = false;
                    }
                }

                document.addEventListener('touchmove', onTouchMove);
                document.addEventListener('touchend', onTouchEnd);
            }

            function getAngle(touches) {
                let dx = touches[1].clientX - touches[0].clientX;
                let dy = touches[1].clientY - touches[0].clientY;
                return Math.atan2(dy, dx) * (180 / Math.PI);
            }

            item.ondragstart = function() {
                return false;
            };
        });

        document.addEventListener('contextmenu', event => event.preventDefault());
    </script>
</body>
</html>
